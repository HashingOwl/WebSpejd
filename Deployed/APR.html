<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autoparametric resonance</title>
    <script src="https://cdn.plot.ly/plotly-2.20.0.min.js" charset="utf-8"></script>
</head>
<body>
    <div id="plot" style="width: 1000px; height: 300px;"></div>
    <div id="plot2" style="width: 1000px; height: 300px;"></div>
    <script>
        const exp = (fjederKonstant, snorlængde, masse, dt, T, x0, y0) => {
            let xArr = [x0]
            let yArr = [y0]
            let xSpeedArr = [0]
            let ySpeedArr = [0]
            let energi = []
            let timeArr = []
            //masse =  fjederKonstant*snorlængde/(3*9.82)
            const accKoef = dt/masse
            let i = 0
            for (let t = 0; t <= T; t += dt) {
                const x = xArr[i]
                const y = yArr[i]

                const lenght = Math.sqrt(x*x+y*y)
                const F =  (lenght - snorlængde) * fjederKonstant
                const Fx = -x/lenght * F
                const Fy = -y/lenght * F //Altid positiv

                xSpeedArr.push((xSpeedArr[i] + Fx * accKoef) * 0.98)
                ySpeedArr.push((ySpeedArr[i] + Fy * accKoef - 9.82 * dt) * 0.98)

                xArr.push(x + xSpeedArr[i] * dt)
                yArr.push(y + ySpeedArr[i] * dt)
                i++
                timeArr.push(t)

                energi.push((0.5 * xSpeedArr[i] * xSpeedArr[i] + ySpeedArr[i]*ySpeedArr[i] * masse + y*9.82*masse + 0.5 * (lenght - snorlængde) * (lenght - snorlængde) * fjederKonstant)*0.1) 
            }
            console.log(xArr)
            console.log(yArr)
            var data = [
                {
                    x: timeArr,
                    y: xArr,
                    mode: "scatter"
                },
                {
                    x: timeArr,
                    y: yArr,
                    mode: "scatter"
                },
                {
                    x: timeArr,
                    y: energi,
                    mode: "scatter"
                }
                // {
                //     x: xArr,
                //     y: yArr,
                //     mode: "scatter"
                // }
            ]
            return data
        }
        var layout = {
        };
        Plotly.newPlot("plot", exp(3, 10, 10, 0.2, 300, 7, -10), layout)
    </script>
</body>
</html>